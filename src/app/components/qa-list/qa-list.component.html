<div class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
  
  <!-- Header mejorado con gradiente sutil -->
  <div class="bg-gradient-to-r from-gray-50 to-blue-50 p-6 border-b border-gray-200">
    <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4">
      
      <!-- Título y descripción -->
      <div class="flex-1">
        <h2 class="text-2xl font-bold text-gray-900 mb-1">
          Base de Conocimiento Q&A
        </h2>
        <p class="text-sm text-gray-600">
          Gestiona las preguntas y respuestas de tu asistente virtual
        </p>
      </div>

      <!-- Controles superiores -->
      <div class="flex flex-col sm:flex-row gap-3 w-full lg:w-auto">
        <!-- Campo de búsqueda mejorado -->
        <mat-form-field appearance="outline" class="flex-1 lg:w-80">
          <mat-label>Buscar preguntas, respuestas o categorías</mat-label>
          <input matInput 
                 (keyup)="applyFilter($event)" 
                 placeholder="Ej: precios, saludos, soporte..."
                 #searchInput>
          <mat-icon matSuffix class="text-gray-400">search</mat-icon>
          <!-- Botón para limpiar búsqueda -->
          <button *ngIf="searchInput.value" 
                  mat-icon-button 
                  matSuffix 
                  (click)="clearFilter(searchInput)"
                  matTooltip="Limpiar búsqueda">
            <mat-icon class="text-gray-400">clear</mat-icon>
          </button>
        </mat-form-field>

        <!-- Botón de añadir mejorado -->
        <button mat-flat-button 
                class="!bg-gradient-to-r !from-blue-600 !to-indigo-600 hover:!from-blue-700 hover:!to-indigo-700 !text-white !font-semibold !px-6 !py-3 !shadow-lg hover:!shadow-xl !transition-all !duration-200 !transform hover:!scale-105 whitespace-nowrap"
                (click)="openCreateDialog()">
          <mat-icon class="mr-2">add_circle</mat-icon>
          Añadir Q&A
        </button>
      </div>
    </div>

    <!-- Estadísticas rápidas -->
    <div class="mt-4 flex flex-wrap gap-4 text-sm">
      <div class="flex items-center text-gray-600">
        <mat-icon class="text-blue-500 mr-1 text-base">quiz</mat-icon>
        <span class="font-medium">{{totalQuestions || 0}}</span>
        <span class="ml-1">preguntas</span>
      </div>
      <div class="flex items-center text-gray-600">
        <mat-icon class="text-green-500 mr-1 text-base">category</mat-icon>
        <span class="font-medium">{{totalCategories || 0}}</span>
        <span class="ml-1">categorías</span>
      </div>
    </div>
  </div>

  <!-- Contenedor de la tabla con animación -->
  <div class="table-container">
    <div class="overflow-x-auto">
      <table mat-table [dataSource]="dataSource" matSort class="w-full min-w-[800px]">

        <!-- Columna ID mejorada -->
        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef mat-sort-header class="w-20"> 
            <div class="flex items-center">
              <mat-icon class="text-gray-400 mr-1 text-base">tag</mat-icon>
              ID 
            </div>
          </th>
          <td mat-cell *matCellDef="let row" class="font-mono text-sm text-gray-500"> 
            #{{row.id}}
          </td>
        </ng-container>

        <!-- Columna Pregunta mejorada -->
        <ng-container matColumnDef="pregunta">
          <th mat-header-cell *matHeaderCellDef mat-sort-header class="w-1/3"> 
            <div class="flex items-center">
              <mat-icon class="text-blue-500 mr-1 text-base">help_outline</mat-icon>
              Pregunta
            </div>
          </th>
          <td mat-cell *matCellDef="let row" class="py-4">
            <div class="text-truncate">
              <span class="font-semibold text-gray-900 leading-relaxed" 
                    [matTooltip]="row.pregunta.length > 50 ? row.pregunta : null">
                {{row.pregunta}}
              </span>
            </div>
          </td>
        </ng-container>

        <!-- Columna Respuesta mejorada -->
        <ng-container matColumnDef="respuesta">
          <th mat-header-cell *matHeaderCellDef class="w-1/3"> 
            <div class="flex items-center">
              <mat-icon class="text-green-500 mr-1 text-base">chat_bubble_outline</mat-icon>
              Respuesta
            </div>
          </th>
          <td mat-cell *matCellDef="let row" class="py-4">
            <div class="text-truncate">
              <span class="text-gray-700 text-sm leading-relaxed" 
                    [matTooltip]="row.respuesta.length > 60 ? row.respuesta : null">
                {{row.respuesta}}
              </span>
            </div>
          </td>
        </ng-container>

        <!-- Columna Categoría mejorada -->
        <ng-container matColumnDef="categoria">
          <th mat-header-cell *matHeaderCellDef mat-sort-header class="w-32"> 
            <div class="flex items-center">
              <mat-icon class="text-purple-500 mr-1 text-base">category</mat-icon>
              Categoría
            </div>
          </th>
          <td mat-cell *matCellDef="let row" class="py-4">
            <span class="category-badge"
                  [ngClass]="{
                    'bg-blue-100 text-blue-700 border border-blue-200': row.categoria === 'Saludos',
                    'bg-green-100 text-green-700 border border-green-200': row.categoria === 'Ventas',
                    'bg-yellow-100 text-yellow-700 border border-yellow-200': row.categoria === 'Soporte',
                    'bg-purple-100 text-purple-700 border border-purple-200': row.categoria === 'Productos',
                    'bg-red-100 text-red-700 border border-red-200': row.categoria === 'Reclamos',
                    'bg-gray-100 text-gray-700 border border-gray-200': row.categoria === 'General'
                  }">
              <mat-icon class="text-xs mr-1" 
                        [ngClass]="{
                          'text-blue-600': row.categoria === 'Saludos',
                          'text-green-600': row.categoria === 'Ventas',
                          'text-yellow-600': row.categoria === 'Soporte',
                          'text-purple-600': row.categoria === 'Productos',
                          'text-red-600': row.categoria === 'Reclamos',
                          'text-gray-600': row.categoria === 'General'
                        }">
                {{getCategoryIcon(row.categoria)}}
              </mat-icon>
              {{row.categoria}}
            </span>
          </td>
        </ng-container>

        <!-- Columna Acciones mejorada -->
        <ng-container matColumnDef="acciones">
          <th mat-header-cell *matHeaderCellDef class="w-32 text-center"> 
            <div class="flex items-center justify-center">
              <mat-icon class="text-gray-400 mr-1 text-base">settings</mat-icon>
              Acciones
            </div>
          </th>
          <td mat-cell *matCellDef="let row" class="py-4">
            <div class="flex items-center justify-center space-x-2">
              <button mat-icon-button 
                      class="action-button !text-blue-600 hover:!bg-blue-50" 
                      matTooltip="Editar pregunta y respuesta"
                      matTooltipPosition="above"
                      (click)="onEdit(row.id, row.pregunta, row.respuesta, row.categoria)">
                <mat-icon class="text-lg">edit</mat-icon>
              </button>
              <button mat-icon-button 
                      class="action-button !text-red-600 hover:!bg-red-50" 
                      matTooltip="Eliminar Q&A"
                      matTooltipPosition="above"
                      (click)="onDelete(row.id)">
                <mat-icon class="text-lg">delete_outline</mat-icon>
              </button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns" class="sticky top-0 z-10"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" 
            class="hover:bg-gray-50 transition-colors duration-150"></tr>

        <!-- Mensaje mejorado cuando no hay datos -->
        <tr class="mat-mdc-row" *matNoDataRow>
          <td class="mat-mdc-cell text-center py-12" [attr.colspan]="displayedColumns.length">
            <div class="flex flex-col items-center space-y-3">
              <mat-icon class="text-gray-300 text-5xl">search_off</mat-icon>
              <div class="text-center">
                <h3 class="text-lg font-semibold text-gray-700 mb-1">No se encontraron resultados</h3>
                <p class="text-gray-500 text-sm" *ngIf="searchInput?.value">
                  No hay datos que coincidan con "<strong>{{searchInput.value}}</strong>"
                </p>
                <p class="text-gray-500 text-sm" *ngIf="!searchInput?.value">
                  Aún no hay preguntas y respuestas registradas
                </p>
              </div>
              <button mat-stroked-button 
                      color="primary" 
                      (click)="searchInput ? clearFilter(searchInput) : openCreateDialog()"
                      class="mt-2">
                <mat-icon class="mr-1">
                  {{searchInput?.value ? 'clear' : 'add'}}
                </mat-icon>
                {{searchInput?.value ? 'Limpiar filtros' : 'Añadir primera Q&A'}}
              </button>
            </div>
          </td>
        </tr>
      </table>
    </div>

    <!-- Paginador mejorado -->
    <mat-paginator 
      [pageSizeOptions]="[5, 10, 25, 50, 100]" 
      [pageSize]="10"
      showFirstLastButtons
      aria-label="Seleccionar página de resultados"
      class="border-t border-gray-100">
    </mat-paginator>
  </div>

</div>